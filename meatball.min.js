!function(){function e(){var e=document.createElement("script");e.type="text/javascript",e.src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js",document.body.appendChild(e),e.onload=function(){var e=[].slice.call(document.getElementsByTagName("table"));!function(e){if(!e)return console.error("Undefined"),!0;if(e.length&&0===e.length)return console.error("Nothing in the array"),!0;return!1}(e)?(e=e.filter(function(e){return"ms-listviewtable"===e.getAttribute("class")})).forEach(function(e,n){var r=e.getAttribute("id").substring(1,37),l=ctx.HttpRoot,i=(e.summary,l+"/_api/web/lists('"+r+"')/fields");$.ajax({url:i,type:"GET",headers:{Accept:"application/json; odata=verbose","Content-Type":"application/json;odata=verbose",credentials:!0,"X-RequestDigest":$("#__REQUESTDIGEST").val()},success:function(n){if(n&&n.d){var r=n.d.results.reduce(function(e,n,r,l){var i=!0;if(t(n.Title,"status")&&(t(n.Title,"value")&&(e.value.indexOf(n.Choices.results)<0&&(e.value.push(n.Choices.results),i=!1),e.value.indexOf(n.InternalName)<0&&(e.internalColumn.push(n.InternalName),i=!1)),i&&n.Formula)){var a=function(e){var t=/([()])/g,n=e.split("IF")[1].split("=")[0].split(",");switch(n.length){case 1:return n[0].replace(t,"");case 2:return n[1].replace(t,"");default:throw new Error("Formula incorrect size")}}(n.Formula);a.indexOf("[")>-1&&(a=a.substring(1,a.length-1)),e.externalColumn.push(a)}return e},{externalColumn:[],internalColumn:[],value:[]});r.value.forEach(function(n,l){!function(e,n,r,l){if(!e||0===e.childNodes.length)return;var i=[].slice.call(e.getElementsByTagName("tr")),a=[].slice.call(e.getElementsByTagName("th")),o="";i.map(function(i,s){o="";var c=[].slice.call(i.getElementsByTagName("td"));c.length>0&&c.map(function(s,c){var d=!1;a[c]&&[].slice.call(a[c].children).forEach(function(e,n){[].slice.call(e.children).forEach(function(e,n){e.innerText&&t(e.innerText,"status")&&(d=!t(e.innerText,"value")&&!t(e.innerText,"type"),t(r,e.innerText)?r.split(" ").length-1===e.innerText.split(" ").length&&(o=s.innerText):d=!1)})}),d&&e.getAttribute("id")&&i.getAttribute("iid")&&([].slice.call(s.children).forEach(function(e,t){[].slice.call(e.children).forEach(function(e,t){o?o.length<1&&(o=e.getAttribute("key")):o=e.getAttribute("key")})}),o&&function(e,n,r,l,i,a,o,s){var c=document.createElement("div");c.style.backgroundColor="\t#676767",c.style.color="#f2f3f4",c.style.padding=".5rem",c.style.border="1px solid",c.style.borderRadius=".25rem",c.style.fontWeight="bold",c.style.zIndex="1";var d=document.createElement("div");d.style.padding=".25rem",d.style.borderRadius=".25rem",d.style.textAlign="center",d.style.cursor="pointer",d.style.marginBottom=".25rem",d.style.backgroundColor="#3D71EB",d.innerText=r,d.style.textShadow="1px 1px 1px black";var u=document.createElement("div");u.style.display="none",u.style.padding=".25rem",u.style.borderRadius=".25rem",n.forEach(function(e,n){var o=document.createElement("div");o.style.padding=".25rem",o.style.marginBottom=".25rem",o.style.textAlign="left",o.style.fontWeight="bold",o.style.borderRadius=".25rem";var c=document.createElement("div");c.innerText=e,c.style.marginLeft=".25rem",c.style.display="inline";var d=document.createElement("input");d.type="radio",d.style.margin="0px",d.style.display="inline",c.style.textShadow="1px 1px 1px black",d.style.color="#f5f5f5",c.style.color="#f5f5f5",o.style.backgroundColor="#3D71EB",t(e,r)?d.checked="checked":(d.style.cursor="pointer",o.style.cursor="pointer",o.addEventListener("click",function(){!function(e,t,n,r,l,i){var a=_spPageContextInfo.webServerRelativeUrl,o=(ctx.ListTitle,{__metadata:{type:"SP.ListItem"}});o[i]=e;var s=a+"/_api/web/lists('"+r+"')/items("+t+")?$select="+i;$.ajax({url:s,type:"POST",data:JSON.stringify(o),headers:{Accept:"application/json; odata=verbose","Content-Type":"application/json;odata=verbose",credentials:!0,"If-Match":"*","X-HTTP-Method":"MERGE","X-RequestDigest":$("#__REQUESTDIGEST").val()},success:function(e){return alert("Updated Target Successfully"),location.reload(),!1},error:function(e){alert("Error: Update Request Failed. Please Contact the 1MEF IMO",console.log(JSON.stringify(e)))}})}(e,l,i.innerText,a,0,s)})),o.appendChild(d),o.appendChild(c),u.appendChild(o)}),c.appendChild(d),c.appendChild(u),d.addEventListener("click",function(){var e=u.style.display,t=!1;t="block"===e,u.style.display=t?"none":"block"}),e.addEventListener("mouseenter",function(){document.body.appendChild(c),c.style.position="fixed",c.style.left=e.getBoundingClientRect().right+"px",c.style.top=e.getBoundingClientRect().top+"px"}),e.addEventListener("mouseleave",function(e){c.contains(e.relatedTarget)||c&&c.parentNode&&c.parentNode.removeChild(c)}),c.addEventListener("mouseleave",function(){u.style.display="none",c&&c.parentNode&&c.parentNode.removeChild(c)})}(s,n,o,i.getAttribute("iid").split(",")[1],a[c],e.getAttribute("id").substring(1,37),0,l))})})}(e,n,r.externalColumn[l],r.internalColumn[l])})}return!1},error:function(e){console.log("Error: Get list choices request Failed.")}})}):console.log("No Tables Found")}}function t(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>-1}window.addEventListener("load",function(){e()}),window.addEventListener("hashchange",function(){e()})}();
